CREATE DATABASE SITETAROT;

USE SITETAROT;

CREATE TABLE USUARIO (
ID_USUARIO INT PRIMARY KEY AUTO_INCREMENT,
NOME_USUARIO VARCHAR(100),
EMAIL_USUARIO VARCHAR(100),
SENHA_USUARIO VARCHAR(100),
GENERO_USUARIO CHAR(1),
CHECK(GENERO_USUARIO = 'm' OR GENERO_USUARIO = 'f' OR GENERO_USUARIO = 'x'),
NASCIMENTO_USUARIO DATE);

CREATE TABLE ARCANOS (
NUMERO_ARCANO INT PRIMARY KEY NOT NULL,
NOME_ARCANO VARCHAR(45),
NAIPE_ARCANO VARCHAR(45),
CATEGORIA_ARCANO VARCHAR(45));

CREATE TABLE DADOS (
ID_DADOS INT PRIMARY KEY AUTO_INCREMENT,
FK_USUARIO INT,
FK_ARCANOS INT,
HORARIO TIME,
DIA DATE,
TIRAGENS INT,
FOREIGN KEY(FK_USUARIO) REFERENCES USUARIO(ID_USUARIO),
FOREIGN KEY(FK_ARCANOS) REFERENCES ARCANOS(NUMERO_ARCANO));

CREATE TABLE KEYWORDS (
ID_KEYWORD INT PRIMARY KEY,
KEY1 VARCHAR(45),
KEY2 VARCHAR(45),
KEY3 VARCHAR(45),
FK_ARCANOS INT,
FOREIGN KEY(FK_ARCANOS) REFERENCES ARCANOS(NUMERO_ARCANO));


INSERT INTO ARCANOS (NUMERO_ARCANO, NOME_ARCANO, NAIPE_ARCANO) VALUES
(0,'O LOUCO','ESPÍRITO'),
(1,'O MAGO','ESPÍRITO'),
(2,'A SACERDOTIZA','ESPÍRITO'),
(3,'A IMPERATRIZ','ESPÍRITO'),
(4,'O IMPERADOR','ESPÍRITO'),
(5,'O HIEROFANTE','ESPÍRITO'),
(6,'OS AMANTES','ESPÍRITO'),
(7,'O CARRO','ESPÍRITO'),
(8,'A JUSTIÇA','ESPÍRITO'),
(9,'O EREMITA','ESPÍRITO'),
(10,'A FORTUNA','ESPÍRITO'),
(11,'A FORÇA','ESPÍRITO'),
(12,'O ENFORCADO','ESPÍRITO'),
(13,'A MORTE','ESPÍRITO'),
(14,'A TEMPERANÇA','ESPÍRITO'),
(15,'O DIABO','ESPÍRITO'),
(16,'A TORRE','ESPÍRITO'),
(17,'A ESTRELA','ESPÍRITO'),
(18,'A LUA','ESPÍRITO'),
(19,'O SOL','ESPÍRITO'),
(20,'O JULGAMENTO','ESPÍRITO'),
(21,'O MUNDO','ESPÍRITO'),
(22,'ÁS DE PAUS','FOGO'),
(23,'2 DE PAUS','FOGO'),
(24,'3 DE PAUS','FOGO'),
(25,'4 DE PAUS','FOGO'),
(26,'5 DE PAUS','FOGO'),
(27,'6 DE PAUS','FOGO'),
(28,'7 DE PAUS','FOGO'),
(29,'8 DE PAUS','FOGO'),
(30,'9 DE PAUS','FOGO'),
(31,'10 DE PAUS','FOGO'),
(32,'CAVALEIRO DE PAUS','FOGO'),
(33,'RAINHA DE PAUS','FOGO'),
(34,'PRINCIPE DE PAUS','FOGO'),
(35,'PRINCESA DE PAUS','FOGO'),
(36,'ÁS DE COPAS','ÁGUA'),
(37,'2 DE COPAS','ÁGUA'),
(38,'3 DE COPAS','ÁGUA'),
(39,'4 DE COPAS','ÁGUA'),
(40,'5 DE COPAS','ÁGUA'),
(41,'6 DE COPAS','ÁGUA'),
(42,'7 DE COPAS','ÁGUA'),
(43,'8 DE COPAS','ÁGUA'),
(44,'9 DE COPAS','ÁGUA'),
(45,'10 DE COPAS','ÁGUA'),
(46,'CAVALEIRO DE COPAS','ÁGUA'),
(47,'RAINHA DE COPAS','ÁGUA'),
(48,'PRINCIPE DE COPAS','ÁGUA'),
(49,'PRINCESA DE COPAS','ÁGUA'),
(50,'ÁS DE ESPADAS','AR'),
(51,'2 DE ESPADAS','AR'),
(52,'3 DE ESPADAS','AR'),
(53,'4 DE ESPADAS','AR'),
(54,'5 DE ESPADAS','AR'),
(55,'6 DE ESPADAS','AR'),
(56,'7 DE ESPADAS','AR'),
(57,'8 DE ESPADAS','AR'),
(58,'9 DE ESPADAS','AR'),
(59,'10 DE ESPADAS','AR'),
(60,'CAVALEIRO DE ESPADAS','AR'),
(61,'RAINHA DE ESPADAS','AR'),
(62,'PRINCIPE DE ESPADAS','AR'),
(63,'PRINCESA DE ESPADAS','AR'),
(64,'ÁS DE MOEDAS','TERRA'),
(65,'2 DE MOEDAS','TERRA'),
(66,'3 DE MOEDAS','TERRA'),
(67,'4 DE MOEDAS','TERRA'),
(68,'5 DE MOEDAS','TERRA'),
(69,'6 DE MOEDAS','TERRA'),
(70,'7 DE MOEDAS','TERRA'),
(71,'8 DE MOEDAS','TERRA'),
(72,'9 DE MOEDAS','TERRA'),
(73,'10 DE MOEDAS','TERRA'),
(74,'CAVALEIRO DE MOEDAS','TERRA'),
(75,'RAINHA DE MOEDAS','TERRA'),
(76,'PRINCIPE DE MOEDAS','TERRA'),
(77,'PRINCESA DE MOEDAS','TERRA');

INSERT INTO KEYWORDS (FK_ARCANOS, KEY1, KEY2, KEY3) VALUES
(0,'BUSCA','DESAPEGO','IMPULSO'),
(1,'MAESTRIA','MAGIA','CRIATIVIDADE'),
(2,'SABEDORIA','INTUIÇÃO','MISTÉRIO'),
(3,'ABUNDÂNCIA','RIQUEZA','GRAVIDEZ'),
(4,'PODER','FIRMEZA','ORDEM'),
(5,'CONSCIÊNCIA','ENSINO','PROTEÇÃO'),
(6,'ESCOLHA','EQUILIBRIO','UNIÃO'),
(7,'VITÓRIA','REALIZAÇÃO','MOBILIDADE'),
(8,'JUSTIÇA','EQUILIBRIO','ORDEM'),
(9,'RECOLHIMENTO','SABEDORIA','MEDITAÇÃO'),
(10,'CICLOS','SORTE','FORTUNA'),
(11,'CORAGEM','TESÃO','CALMA'),
(12,'SACRIFÍCIO','ACEITAÇÃO','PONTO DE VISTA'),
(13,'TRANSFORMAÇÃO','RENASCIMENTO','DESTRUIÇÃO'),
(14,'HARMONIA','ALQUIMIA','TOLERÂNCIA'),
(15,'LUXÚRIA','PROVAÇÃO','PRISÃO'),
(16,'ABERTURA','QUEBRA','LIBERTAÇÃO'),
(17,'ESPERANÇA','CONFIANÇA','PROTEÇÃO'),
(18,'IMAGINAÇÃO','ILUSÃO','SONHOS'),
(19,'VITALIDADE','ALEGRIA','LUZ'),
(20,'DESPERTAR','RENOVAÇÃO','PERCEPÇÃO'),
(21,'CONCLUSÃO','RECOMPENSA','RECONHECIMENTO'),
(22,'COMEÇO','CRIAÇÃO','NASCIMENTO'),
(23,'DOMÍNIO','CONTROLE','AUTOCONFIANÇA'),
(24,'VIRTUDE','CAPACIDADE','INTENÇÃO'),
(25,'CONCLUSÃO','MANIFESTAÇÃO','ESTABILIDADE'),
(26,'BRIGA','RIVALIDADE','CONFLITO'),
(27,'VITÓRIA','CONFIANÇA','ALEGRIA'),
(28,'VALOR','DESAFIO','CORAGEM'),
(29,'VELOCIDADE','ENERGIA','ATIVO'),
(30,'FORÇA','RESISTÊNCIA','DEFESA'),
(31,'SOBRECARGA','RESPONSABILIDADE','RESTRIÇÃO'),
(32,'GENEROSIDADE','FEROCIDADE','IMPULSIVIDADE'),
(33,'CONDUÇÃO','PURIFICAÇÃO','INSPIRAÇÃO'),
(34,'ANIMAÇÃO','EXTROVERSÃO','SEDUÇÃO'),
(35,'POTENCIAL','CENTELHA','ARRISCAR'),
(36,'NUTRIÇÃO','FERTILIDADE','ABUNDÂNCIA'),
(37,'AMOR','CONEXÃO','RELACIONAMENTO'),
(38,'ABUNDÂNCIA','ALEGRIA','GRAÇA'),
(39,'DESCONTENTAMENTO','SATISFAÇÃO','CONFORTO'),
(40,'DECEPÇÃO','PESAR','CHORAR'),
(41,'PRAZER','INOCÊNCIA','INFÂNCIA'),
(42,'DEVASSIDÃO','ESCAPISMO','FANTASIA'),
(43,'INDOLÊNCIA','PERDA','ABANDONO'),
(44,'FELICIDADE','ORGULHO','PLENITUDE'),
(45,'SACIEDADE','AMIZADE','SALVAÇÃO'),
(46,'ELEGÂNCIA','AMÁVEL','JOVIAL'),
(47,'MATURIDADE','PUREZA','SABEDORIA'),
(48,'IDEALISTA','REGENERADOR','ARTISTA'),
(49,'VIRGINDADE','GRACIOSIDADE','DOÇURA'),
(50,'INTELECTO','RAZÃO','LÓGICA'),
(51,'PAZ','ACEITAÇÃO','IMPASSE'),
(52,'PESAR','TRAIÇÃO','RUPTURA'),
(53,'TRÉGUA','MEDITAÇÃO','AFASTAMENTO'),
(54,'DERROTA','INJUSTIÇA','HUMILHAÇÃO'),
(55,'CIÊNCIA','TRANSIÇÃO','TRAVESSIA'),
(56,'FUTILIDADE','MALANDRAGEM','DESONESTIDADE'),
(57,'INTERFERÊNCIA','PRISÃO','RESTRIÇÃO'),
(58,'CRUELDADE','PESADELO','AUTOSABOTAGEM'),
(59,'OPRESSÃO','FUNDO DO POÇO','FARDO'),
(60,'DEFENSIVO','OBSTINADO','SEVERO'),
(61,'CASTIGO','SERIEDADE','SEPARAÇÃO'),
(62,'COMBATIVO','CORAJOSO','TIRANIA'),
(63,'DIFÍCIL','ABORTO','ALUNO'),
(64,'SEMENTE','FORMA','TERRA'),
(65,'MUDANÇA','CICLO','EXPANSÃO'),
(66,'TRABALHO','ESFORÇO','MANIFESTAÇÃO'),
(67,'PODER','DEPENDÊNCIA','AVAREZA'),
(68,'PREOCUPAÇÃO','DIFICULDADES','POBREZA'),
(69,'SUCESSO','GENEROSIDADE','CARIDADE'),
(70,'DERROTA','ESPERA','ATENÇÃO'),
(71,'PRUDÊNCIA','TREINO','APRENDIZADO'),
(72,'GANHO','COLHEITA','LUXO'),
(73,'RIQUEZA','ESTABILIDADE','SACIEDADE'),
(74,'ASCENSÃO','CONFIÁVEL','PRÁTICO'),
(75,'PRESERVAÇÃO','SENSATEZ','MATURIDADE'),
(76,'CONCENTRAÇÃO','CONFIANÇA','LEALDADE'),
(77,'MATERNIDADE','CONCLUSÃO','FEMINILIDADE');


INSERT INTO DADOS (FK_USUARIO,FK_ARCANOS) VALUES
(1,25),
(1,43),
(1,66),
(1,12),
(1,44),
(1,55),
(1,12),
(1,7),
(1,28),
(1,37),
(1,59),
(1,73),
(1,9),
(1,15),
(1,15),
(1,8),
(1,17),
(1,77),
(1,19),
(1,44),
(1,41),
(1,29),
(1,22),
(1,5),
(1,13),
(1,69),
(1,15);

/* SELECTS PARA ADD NA API */

-- COLOCAR NA METRICA CARTAS TIRADAS
SELECT COUNT(ARCANOS.NUMERO_ARCANO) FROM DADOS JOIN USUARIO ON ID_USUARIO = FK_USUARIO JOIN ARCANOS ON NUMERO_ARCANO = FK_ARCANOS;

-- COLOCAR NA DIVISÃO POR NAIPE
SELECT NAIPE_ARCANO AS 'NAIPE', COUNT(NUMERO_ARCANO) AS 'QT' FROM DADOS JOIN USUARIO ON ID_USUARIO = FK_USUARIO JOIN ARCANOS ON NUMERO_ARCANO = FK_ARCANOS GROUP BY NAIPE_ARCANO;

-- PEGANDO A CARTA QUE MAIS SAIU
SELECT NUMERO_ARCANO FROM DADOS JOIN USUARIO ON ID_USUARIO = FK_USUARIO JOIN ARCANOS ON NUMERO_ARCANO = FK_ARCANOS GROUP BY NUMERO_ARCANO ORDER BY COUNT(NUMERO_ARCANO) DESC LIMIT 1;

